var letters =
{
  "A":[[5,3],[[[0,0],[0,3],[5,3],[5,2],[3,2],[3,1],[5,1],[5,0]],[1,2,3,4]], [[[1,1],[1,2],[2,2],[2,1]],[1,2]]],
  "B":[[5,3],[[[0,0],[0,2],[1,2],[1,3],[2,3],[2,2],[3,2],[3,3],[4,3],[4,2],[5,2],[5,0]],[1,2,3,4,5,6,7,8,9,10]], [[[1,1],[1,2],[2,2],[2,1]],[1,2]], [[[3,1],[3,2],[4,2],[4,1]],[1,2]]],
  "C":[[5,3],[[[0,0],[0,3],[2,3],[2,2],[1,2],[1,1],[4,1],[4,2],[3,2],[3,3],[5,3],[5,0]],[1,2,3,4,7,8,9,10]]],
  "D":[[5,3],[[[0,0],[0,2],[1,2],[1,3],[4,3],[4,2],[5,2],[5,0]],[1,2,3,4,5,6]],[[[1,1],[1,2],[4,2],[4,1]],[1,2]]],
  "E":[[5,3],[[[0,0],[0,3],[1,3],[1,1],[2,1],[2,3],[3,3],[3,1],[4,1],[4,3],[5,3],[5,0]],[1,2,5,6,9,10]]],
  "F":[[5,3],[[[0,0],[0,3],[1,3],[1,1],[2,1],[2,3],[3,3],[3,1],[5,1],[5,0]],[1,2,5,6]]],
  "G":[[5,3],[[[0,0],[0,3],[1,3],[1,1],[4,1],[4,2],[2,2],[2,3],[5,3],[5,0]],[1,2,5,6,7,8]]],
  "H":[[5,3],[[[0,0],[0,1],[2,1],[2,2],[0,2],[0,3],[5,3],[5,2],[3,2],[3,1],[5,1],[5,0]],[3,4,5,6,7,8]]],
  "I":[[5,3],[[[0,0],[0,3],[1,3],[1,2],[4,2],[4,3],[5,3],[5,0],[4,0],[4,1],[1,1],[1,0]],[1,2,5,6],[3,4,9,10]]],
  "J":[[5,3],[[[0,0],[0,3],[1,3],[1,2],[5,2],[5,0],[4,0],[4,1],[1,1],[1,0]],[1,2],[3,4,7,8]]],
  "K":[[5,3],[[[0,0],[0,1],[2,1],[2,2],[0,2],[0,3],[2,3],[2,2],[3,2],[3,3],[5,3],[5,2],[3,2],[3,1],[5,1],[5,0]],[3,4,5,6,7,8,9,10,11,12]]],
  "L":[[5,3],[[[0,0],[0,1],[4,1],[4,3],[5,3],[5,0]],[3,4]]],
  "M":[[5,5],[[[1,0],[1,1],[0,1],[0,2],[1,2],[1,3],[0,3],[0,4],[1,4],[1,5],[5,5],[5,4],[1,4],[1,3],[3,3],[3,2],[1,2],[1,1],[5,1],[5,0]],[7,8,9,10,11,12],[3,4,5,6,13,14,15,16]]],
  "N":[[5,3],[[[0,0],[0,3],[5,3],[5,2],[1,2],[1,1],[5,1],[5,0]],[1,2,3,4]]],
  "O":[[5,3],[[[0,0],[0,3],[5,3],[5,0]],[1,2]], [[[1,1],[1,2],[4,2],[4,1]],[1,2]]],
  "P":[[5,3],[[[0,0],[0,3],[3,3],[3,1],[5,1],[5,0]],[1,2]], [[[1,1],[1,2],[2,2],[2,1]],[1,2]]],
  "Q":[[5,3],[[[0,0],[0,3],[5,3],[5,2],[4,2],[4,0]],[1,2,3,4]], [[[1,1],[1,2],[3,2],[3,1]],[1,2]]],
  "R":[[5,3],[[[0,0],[0,2],[1,2],[1,3],[2,3],[2,2],[3,2],[3,3],[5,3],[5,2],[3,2],[3,1],[5,1],[5,0]],[1,2,3,4,5,6,7,8,9,10]], [[[1,1],[1,2],[2,2],[2,1]],[1,2]]],
  "S":[[5,3],[[[0,0],[0,3],[1,3],[1,1],[2,1],[2,3],[5,3],[5,0],[4,0],[4,2],[3,2],[3,0]],[1,2,5,6,9,10]]],
  "T":[[5,3],[[[0,0],[0,3],[1,3],[1,2],[5,2],[5,1],[1,1],[1,0]],[1,2],[3,4,5,6]]],
  "U":[[5,3],[[[0,0],[0,1],[4,1],[4,2],[0,2],[0,3],[5,3],[5,0]],[3,4,5,6]]],
  "V":[[5,3],[[[0,0],[0,1],[4,1],[4,2],[0,2],[0,3],[4,3],[4,2],[5,2],[5,1],[4,1],[4,0]],[3,4,5,6,7,8]]],
  "W":[[5,5],[[[0,0],[0,1],[4,1],[4,2],[2,2],[2,3],[4,3],[4,4],[0,4],[0,5],[4,5],[4,4],[5,4],[5,3],[4,3],[4,2],[5,2],[5,1],[4,1],[4,0]],[7,8,9,10,11,12],[3,4,5,6,13,14,15,16]]],
  "X":[[5,3],[[[0,0],[0,1],[2,1],[2,2],[0,2],[0,3],[2,3],[2,2],[3,2],[3,3],[5,3],[5,2],[3,2],[3,1],[5,1],[5,0],[3,0],[3,1],[2,1],[2,0]],[3,4,5,6,7,8,9,10,11,12]]],
  "Y":[[5,3],[[[0,0],[0,1],[2,1],[2,2],[0,2],[0,3],[5,3],[5,0],[4,0],[4,2],[3,2],[3,0]],[3,4,5,6,9,10]]],
  "Z":[[5,3],[[[0,0],[0,3],[2,3],[2,2],[3,2],[3,1],[4,1],[4,3],[5,3],[5,0],[3,0],[3,1],[2,1],[2,2],[1,2],[1,0]],[1,2,3,4,7,8,13,14]]]
};
var elong = 0;
var stretchFactor = 1.5;

var letterW, letterH;
var currentLetter;

var stretchVal;
var startX, startY;

var letterColor = 0;
var backgroundColor = 255;

var sizeMult = 10;
var spaceVal = 10;

var active;
var stopFlag;

function setup() {
  createCanvas(window.innerWidth, window.innerHeight);
  background(backgroundColor);
  noStroke();

  startX = 0;
  startY = 0;

  active = true;
  stopFlag = false;
  currentLetter = "";
}

function draw() {
  if (active){
    if (keyIsPressed && keyCode > 96 && keyCode < 123) {

      var let = key.toUpperCase();
      console.log(key);
      if (let == currentLetter || currentLetter == ""){currentLetter = let;}
      else {
        newLetter();
        console.log('new letter from multiple!');
        currentLetter = let;
      }

      var activeLetter = letters[let];

      fill(backgroundColor);
      letterW = activeLetter[0][1] * sizeMult;
      letterH = activeLetter[0][0] * sizeMult;
      rect(startX, startY, startX + letterW, startY + letterH); //new frame

      for (i=1; i<activeLetter.length; i++) {
        if (i==1) {fill(255-elong);}
        else {fill(backgroundColor);}
        beginShape();
        for (j=0; j<activeLetter[i][0].length; j++) {
          var x = activeLetter[i][0][j][1] * sizeMult + startX;
          if (x > width-10){
            stopFlag = true;
            console.log("over!");
          }
          var y = activeLetter[i][0][j][0] * sizeMult + startY;
          vertex(x, y);
        }
        endShape();

        if (stopFlag){
          console.log('end of line!');
          active = false;
          newLine();
        }
      }

      elong += 3;
      if (elong>255){elong = 255;}
    }

    else if (!keyIsPressed){
      currentLetter = "";
    }
  }
}

function newLine(){
  startX = 0;
  startY += spaceVal + letterH;
  elong = 0;
}

function newLetter(){
  startX += spaceVal + letterW;
  elong = 0;
  active = true;
}

function keyReleased(){
  if (keyCode == 13){newLine();} //enter
  else if (keyCode == 32){
    console.log('space!');
    startX += 40;
  } //space
  // else (keyCode > 96 && keyCode < 123) {
  else if (key.toUpperCase() == currentLetter){
    console.log('newletter from release!');
    newLetter();
  }
}
